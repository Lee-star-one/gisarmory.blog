# 为什么对点buffer分析得到的是个椭圆

buffer - 图形缓冲区分析，GIS中最基本的空间分析之一。

实现buffer的工具有很多种，例如前端的truf.js、服务端的ArcGISserver、数据库端的PosrGIS、桌面端的ArcMap等都可以实现。

但很多时候你会遇到标题中的那个问题，对点进行buffer分析得到的却是个椭圆。

为什么是椭圆，不应该是正圆吗？

接下来我们就研究一下这个问题。

我们平时用ArcGIS软件比较多，但看它的帮助文档却比较少，其实里面有很多内容写的都非常好。

比如这篇 [缓冲区（分析）的工作原理](https://desktop.arcgis.com/zh-cn/arcmap/10.3/tools/analysis-toolbox/how-buffer-analysis-works.htm) 就对上面的问题给出了很专业的回答，在这里和大家一起学习一下。

缓冲区的构建方法有两种：欧式方法 和 测地线方法

欧式方法就是在地图上画圆。测地线方法是在真实的世界中画圆，然后再把这个圆反应到地图上。

额~  看上去，好像没啥区别，举个例子：

假设我们想要查看北京周边500公里的范围内有哪些城市，

欧式方法：找来一张纸质的世界地图，一个圆规，一把尺子。根据地图的比例尺换算出500公里在地图上的长度，然后用圆规以北京为中心，画一个圆。

测地线方法：找来一个软胶皮材质的地球仪，一个圆规，一把尺子。同样根据地球仪的比例尺算出500公里对应的长度，然后用圆规以北京为中心，画一个圆。

（前方高能预警）

接下来，把地球仪拆下来，找到本初子午线，然后把球沿本初子午线从南极点到北极点剪开，对剪开的地球进行拉拽，尽你最大的努力摊平了，

摊平后再去看你之前画的那个圆，看它还圆不圆？

这个把地球仪摊平的过程就是类似二维地图投影的一个过程，现实中的圆展示到二维地图上，要进行投影转换，而这个投影转换会导致圆变形。

到这里，答案揭晓，对点进行buffer分析得到椭圆的原因，是因为**地图投影**导致的变形。

反过来讲，欧式方法在投影后的地图上画的那个圆，如果放到现实中，它也会变形。

通常变形的程度取决于使用的投影方法，和所处的位置。比如在utm投影中，离赤道越远，变形就越严重

那能不能用测地线方法得到一个在任何位置都不会变形的圆呢？答案是能，用三维地图。

地球是个球体，把三维的球体用二维的地图来展示就必须用到投影，但如果直接用三维地图展示，就不需要再投影，也就不会再发生变形。

如果我现在只有二维地图，应该用哪种构建方式呢？

看用途，正常情况下我们都应该使用测地线方法，因为它是对真实世界的表达。但如果你遇到了一个很在意buffer结果圆不圆的客户或领导，而你又解释不明白的时候，用欧式方法也是一种解脱。



最后说一说开发时，这两种构建方法的实现方式



开发时，如果选择构建方法：
arcgis中使用xx参数
postgis中，对xx进行类型转换postgis数据库中的缓冲用xx函数来实现

truf中，xxxx。

## 总结：

1. buffer有两种构建方式，欧式方法和测地线方法
2. 欧式方法是在投影变形后的平面地图上绘制图形，看上去很圆，但在现实中并不准确。
3. 测地线方法是在现实世界中画圆，再经过投影变形展示到地图上，看上去不圆，但实际是准确的。
4. 
5. arcgis server、postGIS 的buffer提供了两种构建方式，truf只提供了xx的构建方式。






参考：https://desktop.arcgis.com/zh-cn/arcmap/10.3/tools/analysis-toolbox/how-buffer-analysis-works.htm

https://developers.arcgis.com/javascript/latest/sample-code/ge-geodesicbuffer/index.html

http://www.postgis.net/docs/ST_Buffer.html